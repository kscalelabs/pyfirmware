#!/usr/bin/env bash

set -euo pipefail

# verify active environment is 'firmware'
env_name="${CONDA_DEFAULT_ENV:-${MAMBA_DEFAULT_ENV:-$(basename "${VIRTUAL_ENV:-}")}}"
if [ "${env_name}" != "firmware" ]; then
    echo "Error: active environment must be 'firmware' (current: '${env_name:-none}')"
    exit 1
fi

echo "Running sine wave test to test actuators and CAN bus on 10% pd gains..."

# bring up CAN and set max torques per actuator
_set_can_and_max_torques.sh

# run sine wave test
python -m firmware.can


